{"version":3,"sources":["webpack:///./src/static/styles/more.scss?f75d","webpack:///./src/static/styles/more.scss","webpack:///./src/containers/More.js"],"names":["content","__webpack_require__","module","i","options","hmr","transform","insertInto","undefined","locals","exports","push","_react","MoreSuggest","props","_classCallCheck3","default","this","_this","_possibleConstructorReturn3","__proto__","_getPrototypeOf2","call","state","needLoader","query","keywords","from","size","apps","loading","loadMore","last","loaded","notListenScroll","loadMoreData","bind","loadData","refreshPage","timeOut","clearTimeout","queryObj","isLoadMore","isRefresh","_this2","_XHR2","history","then","res","success","concat","setState","prevState","length","showRefresh","_assign2","publishTime","window","scrollTo","setTimeout","catch","err","_this3","_react2","createElement","className","_loading2","txt","_Rscroller2","noEmpty","_RefreshBtn2","map","item","index","key","src","cover","url","PUBLIC","cropImg","alt","Component"],"mappings":"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","file":"5.9e7810cf.chunk.js","sourcesContent":["\nvar content = require(\"!!../../../node_modules/css-loader/index.js!../../../node_modules/postcss-loader/lib/index.js!../../../node_modules/sass-loader/lib/loader.js!./more.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../node_modules/css-loader/index.js!../../../node_modules/postcss-loader/lib/index.js!../../../node_modules/sass-loader/lib/loader.js!./more.scss\", function() {\n\t\tvar newContent = require(\"!!../../../node_modules/css-loader/index.js!../../../node_modules/postcss-loader/lib/index.js!../../../node_modules/sass-loader/lib/loader.js!./more.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".page-more {\\n  padding: 15px 15px 60px 15px;\\n  box-sizing: border-box; }\\n  .page-more .page-intro {\\n    font-size: 14px;\\n    margin-left: 5px; }\\n  .page-more .single-card {\\n    width: 100%;\\n    height: 400px;\\n    border-radius: 10px;\\n    overflow: hidden;\\n    margin-top: 10px;\\n    position: relative; }\\n  .page-more .card-img {\\n    width: 100%;\\n    height: 100%; }\\n  .page-more .light-btn {\\n    box-shadow: 0 0 20px 5px #ddd;\\n    background-color: white;\\n    color: black;\\n    border-radius: 35px;\\n    width: 75px;\\n    text-align: center;\\n    height: 35px;\\n    line-height: 35px;\\n    font-size: 15px;\\n    position: absolute;\\n    bottom: 20px;\\n    right: 10px;\\n    z-index: 10; }\\n\", \"\"]);\n\n// exports\n","import React, { Component } from \"react\";\r\nimport \"../static/styles/home.scss\";\r\nimport Rscroller from '../components/Rscroller'\r\nimport PUBLIC from '../public'\r\nimport XHR from '../XHR'\r\nimport Loader from '../components/loading'\r\nimport RefreshBtn from '../components/RefreshBtn'\r\n\r\nimport '../static/styles/more.scss'\r\nexport default class MoreSuggest extends Component{\r\n    constructor(props){\r\n        super(props);\r\n        this.state={\r\n            needLoader:true,\r\n            query: {\r\n                keywords: '',\r\n                from: null,\r\n                size: 10\r\n            },\r\n            apps:[],\r\n            loading:true,\r\n            loadMore:false,\r\n            last:false,\r\n            loaded:false,\r\n            notListenScroll:false\r\n        };\r\n        this.loadMoreData=this.loadMoreData.bind(this)\r\n        this.loadData=this.loadData.bind(this)\r\n        this.refreshPage=this.refreshPage.bind(this)\r\n    }\r\n    async componentDidMount(){\r\n        this.loadData({query:this.state.query},false,false)\r\n    }\r\n    componentWillUnmount(){\r\n        if(this.timeOut){\r\n            clearTimeout(this.timeOut);\r\n            this.timeOut=null;\r\n        }\r\n    }\r\n    loadData(queryObj,isLoadMore,isRefresh){\r\n        XHR('morePageData',queryObj,this.props.history)\r\n            .then(res=>{\r\n                if(res.success && res.apps){\r\n                    let apps=res.apps;\r\n                    if(isLoadMore){\r\n                        apps=this.state.apps.concat(apps)\r\n                    }\r\n                    this.setState(prevState=>({\r\n                        apps:apps,\r\n                        loading:false,\r\n                        loadMore:false,\r\n                        last:res.apps.length<this.state.query.size,\r\n                        loaded:true,\r\n                        showRefresh:false,\r\n                        query:res.apps.length>0 ? Object.assign({},prevState.query,{from:res.apps[res.apps.length-1].publishTime}) : prevState.query\r\n                    }));\r\n                    if(this.state.notListenScroll){\r\n                        window.scrollTo(0,0);\r\n                    }\r\n                    this.timeOut=setTimeout(()=>{\r\n                        this.setState({\r\n                            notListenScroll:false\r\n                        })\r\n                    },1000)\r\n                }\r\n            }).catch((err)=>{\r\n                this.setState({\r\n                    loading:false,\r\n                    loadMore:false,\r\n                    showRefresh:false,\r\n                    notListenScroll:false\r\n                })\r\n            })\r\n    }\r\n    loadMoreData(){\r\n        if(!this.state.last){\r\n            this.setState({\r\n                loadMore:true\r\n            });\r\n            this.loadData({query:this.state.query},true,false)\r\n        }\r\n\r\n    }\r\n    refreshPage(){\r\n        this.setState({\r\n            showRefresh:true,\r\n            notListenScroll:true\r\n        },()=>{\r\n            this.loadData({query:{\r\n                keywords: '',\r\n                from: null,\r\n                size: 10}\r\n            },false,true)\r\n        });\r\n    }\r\n    render(){\r\n        return(\r\n            <div className=\"page-more\">\r\n                {this.state.loading ? <Loader txt={'加载中'}></Loader> :\r\n                    <Rscroller\r\n                        loadMore={!this.state.last}\r\n                        loading={this.state.loadMore}\r\n                        loadMoreData={this.loadMoreData}\r\n                        needLoader={this.state.needLoader}\r\n                        loaded={this.state.loaded}\r\n                        noEmpty={this.state.apps.length>0}\r\n                        notListenScroll={this.state.notListenScroll}\r\n                    >\r\n                        <RefreshBtn\r\n                            refreshPage={this.refreshPage}\r\n                        />\r\n                        {this.state.showRefresh ?\r\n                            <Loader txt={'加载中'}></Loader> : null\r\n                        }\r\n                        <div>\r\n                            <h2>更多推荐<span className=\"page-intro\">要新品也要有趣</span></h2>\r\n                        </div>\r\n                        <div>\r\n                            {this.state.apps.map((item,index)=>\r\n                                <div className=\"single-card\" key={'more'+index}>\r\n                                    <img src={item.cover.url+PUBLIC.cropImg(346,400)} className=\"card-img\" alt=\"\"/>\r\n                                    <div className=\"light-btn\">体验</div>\r\n                                </div>\r\n                            )}\r\n\r\n                        </div>\r\n                    </Rscroller>\r\n                }\r\n\r\n            </div>\r\n        )\r\n    }\r\n}"],"sourceRoot":""}